-- MySQL Script generated by MySQL Workbench
-- Sun Jul  5 18:02:41 2020
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema DBLaborico
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `DBLaborico` ;

-- -----------------------------------------------------
-- Schema DBLaborico
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `DBLaborico` DEFAULT CHARACTER SET utf8 ;
USE `DBLaborico` ;

-- -----------------------------------------------------
-- Table `DBLaborico`.`tipoUsuario`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DBLaborico`.`tipoUsuario` ;

CREATE TABLE IF NOT EXISTS `DBLaborico`.`tipoUsuario` (
  `idTipoUsuario` INT NOT NULL AUTO_INCREMENT,
  `descripcionTipoUsuario` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idTipoUsuario`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `DBLaborico`.`profesion`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DBLaborico`.`profesion` ;

CREATE TABLE IF NOT EXISTS `DBLaborico`.`profesion` (
  `idProfesion` INT NOT NULL AUTO_INCREMENT,
  `descripcionProfesion` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idProfesion`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `DBLaborico`.`usuario`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DBLaborico`.`usuario` ;

CREATE TABLE IF NOT EXISTS `DBLaborico`.`usuario` (
  `idUsuario` INT NOT NULL AUTO_INCREMENT,
  `idTipoUsuario` INT NOT NULL,
  `idProfesion` INT NOT NULL,
  `nombresUsuario` VARCHAR(45) NOT NULL,
  `documentoUsuario` VARCHAR(45) NOT NULL,
  `emailUsuario` VARCHAR(45) NULL,
  `passwordUsuario` VARCHAR(255) NOT NULL,
  `telefonoUsuario` VARCHAR(45) NOT NULL,
  `celularUsuario` VARCHAR(45) NULL,
  `direccionUsuario` VARCHAR(45) NULL,
  `tipoDocumentoUsuario` INT(2) NULL,
  `ciudadUsuario` VARCHAR(45) NULL,
  PRIMARY KEY (`idUsuario`, `idTipoUsuario`, `idProfesion`),
  CONSTRAINT `fk_usuario_tipoUsuario1`
    FOREIGN KEY (`idTipoUsuario`)
    REFERENCES `DBLaborico`.`tipoUsuario` (`idTipoUsuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_usuario_GradoAcademico1`
    FOREIGN KEY (`idProfesion`)
    REFERENCES `DBLaborico`.`profesion` (`idProfesion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_usuario_tipoUsuario1_idx` ON `DBLaborico`.`usuario` (`idTipoUsuario` ASC) VISIBLE;

CREATE INDEX `fk_usuario_GradoAcademico1_idx` ON `DBLaborico`.`usuario` (`idProfesion` ASC) VISIBLE;


-- -----------------------------------------------------
-- Table `DBLaborico`.`tipoPregunta`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DBLaborico`.`tipoPregunta` ;

CREATE TABLE IF NOT EXISTS `DBLaborico`.`tipoPregunta` (
  `idTipoPregunta` INT NOT NULL AUTO_INCREMENT,
  `descripcionTipoPregunta` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idTipoPregunta`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `DBLaborico`.`asignatura`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DBLaborico`.`asignatura` ;

CREATE TABLE IF NOT EXISTS `DBLaborico`.`asignatura` (
  `idAsignatura` INT NOT NULL AUTO_INCREMENT,
  `nombreAsignatura` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idAsignatura`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `DBLaborico`.`pregunta`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DBLaborico`.`pregunta` ;

CREATE TABLE IF NOT EXISTS `DBLaborico`.`pregunta` (
  `idPregunta` INT NOT NULL AUTO_INCREMENT,
  `enunciadoPregunta` VARCHAR(255) NOT NULL,
  `idTipoPregunta` INT NOT NULL DEFAULT 1,
  `idAsignatura` INT NOT NULL,
  `graficoPregunta` VARCHAR(255) NULL,
  PRIMARY KEY (`idPregunta`, `idTipoPregunta`, `idAsignatura`),
  CONSTRAINT `fk_pregunta_tipoPregunta1`
    FOREIGN KEY (`idTipoPregunta`)
    REFERENCES `DBLaborico`.`tipoPregunta` (`idTipoPregunta`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_pregunta_asignatura1`
    FOREIGN KEY (`idAsignatura`)
    REFERENCES `DBLaborico`.`asignatura` (`idAsignatura`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_pregunta_tipoPregunta1_idx` ON `DBLaborico`.`pregunta` (`idTipoPregunta` ASC) VISIBLE;

CREATE INDEX `fk_pregunta_asignatura1_idx` ON `DBLaborico`.`pregunta` (`idAsignatura` ASC) VISIBLE;


-- -----------------------------------------------------
-- Table `DBLaborico`.`respuesta`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DBLaborico`.`respuesta` ;

CREATE TABLE IF NOT EXISTS `DBLaborico`.`respuesta` (
  `idRespuesta` INT NOT NULL AUTO_INCREMENT,
  `descripcionRespuesta` VARCHAR(255) NOT NULL,
  `idPregunta` INT NOT NULL,
  `puntajeRespuesta` INT NOT NULL DEFAULT 0,
  PRIMARY KEY (`idRespuesta`, `idPregunta`),
  CONSTRAINT `fk_respuesta_pregunta1`
    FOREIGN KEY (`idPregunta`)
    REFERENCES `DBLaborico`.`pregunta` (`idPregunta`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_respuesta_pregunta1_idx` ON `DBLaborico`.`respuesta` (`idPregunta` ASC) VISIBLE;


-- -----------------------------------------------------
-- Table `DBLaborico`.`examen`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DBLaborico`.`examen` ;

CREATE TABLE IF NOT EXISTS `DBLaborico`.`examen` (
  `idExamen` INT NOT NULL AUTO_INCREMENT,
  `idUsuario` INT NOT NULL,
  `fechaExamen` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`idExamen`, `idUsuario`),
  CONSTRAINT `fk_examen_usuario1`
    FOREIGN KEY (`idUsuario`)
    REFERENCES `DBLaborico`.`usuario` (`idUsuario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_examen_usuario1_idx` ON `DBLaborico`.`examen` (`idUsuario` ASC) VISIBLE;


-- -----------------------------------------------------
-- Table `DBLaborico`.`examen_has_pregunta`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `DBLaborico`.`examen_has_pregunta` ;

CREATE TABLE IF NOT EXISTS `DBLaborico`.`examen_has_pregunta` (
  `idRegistro` INT NOT NULL AUTO_INCREMENT,
  `idExamen` INT NOT NULL,
  `idPregunta` INT NOT NULL,
  `idAsignatura` INT NOT NULL,
  `idRespuesta` INT NOT NULL,
  PRIMARY KEY (`idRegistro`, `idExamen`, `idPregunta`),
  CONSTRAINT `fk_examen_has_pregunta_examen1`
    FOREIGN KEY (`idExamen`)
    REFERENCES `DBLaborico`.`examen` (`idExamen`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_examen_has_pregunta_pregunta1`
    FOREIGN KEY (`idPregunta`)
    REFERENCES `DBLaborico`.`pregunta` (`idPregunta`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_examen_has_pregunta_pregunta1_idx` ON `DBLaborico`.`examen_has_pregunta` (`idPregunta` ASC) VISIBLE;

CREATE INDEX `fk_examen_has_pregunta_examen1_idx` ON `DBLaborico`.`examen_has_pregunta` (`idExamen` ASC) VISIBLE;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `DBLaborico`.`tipoUsuario`
-- -----------------------------------------------------
START TRANSACTION;
USE `DBLaborico`;
INSERT INTO `DBLaborico`.`tipoUsuario` (`idTipoUsuario`, `descripcionTipoUsuario`) VALUES (1, 'Administrador');
INSERT INTO `DBLaborico`.`tipoUsuario` (`idTipoUsuario`, `descripcionTipoUsuario`) VALUES (2, 'Docente');
INSERT INTO `DBLaborico`.`tipoUsuario` (`idTipoUsuario`, `descripcionTipoUsuario`) VALUES (3, 'Estudiante');
INSERT INTO `DBLaborico`.`tipoUsuario` (`idTipoUsuario`, `descripcionTipoUsuario`) VALUES (4, 'Administrativo');

COMMIT;


-- -----------------------------------------------------
-- Data for table `DBLaborico`.`profesion`
-- -----------------------------------------------------
START TRANSACTION;
USE `DBLaborico`;
INSERT INTO `DBLaborico`.`profesion` (`idProfesion`, `descripcionProfesion`) VALUES (1, '11 - 1');

COMMIT;


-- -----------------------------------------------------
-- Data for table `DBLaborico`.`usuario`
-- -----------------------------------------------------
START TRANSACTION;
USE `DBLaborico`;
INSERT INTO `DBLaborico`.`usuario` (`idUsuario`, `idTipoUsuario`, `idProfesion`, `nombresUsuario`, `documentoUsuario`, `emailUsuario`, `passwordUsuario`, `telefonoUsuario`, `celularUsuario`, `direccionUsuario`, `tipoDocumentoUsuario`, `ciudadUsuario`) VALUES (1, 1, 1, 'administrador', '1', 'administrador@administrador.com', '$2y$10$WkhAKv0GBqJWeBSqRrLN1uhs7DfymtV6T/qNgheXdi7aEbeAsYu3e', DEFAULT, NULL, NULL, NULL, NULL);
INSERT INTO `DBLaborico`.`usuario` (`idUsuario`, `idTipoUsuario`, `idProfesion`, `nombresUsuario`, `documentoUsuario`, `emailUsuario`, `passwordUsuario`, `telefonoUsuario`, `celularUsuario`, `direccionUsuario`, `tipoDocumentoUsuario`, `ciudadUsuario`) VALUES (2, 2, 1, 'docente', '2', 'docente@docente.com', '$2y$10$WkhAKv0GBqJWeBSqRrLN1uhs7DfymtV6T/qNgheXdi7aEbeAsYu3e', DEFAULT, NULL, NULL, NULL, NULL);
INSERT INTO `DBLaborico`.`usuario` (`idUsuario`, `idTipoUsuario`, `idProfesion`, `nombresUsuario`, `documentoUsuario`, `emailUsuario`, `passwordUsuario`, `telefonoUsuario`, `celularUsuario`, `direccionUsuario`, `tipoDocumentoUsuario`, `ciudadUsuario`) VALUES (3, 3, 1, 'estudiante', '3', 'estudiante@estudiante.com', '$2y$10$WkhAKv0GBqJWeBSqRrLN1uhs7DfymtV6T/qNgheXdi7aEbeAsYu3e', DEFAULT, NULL, NULL, NULL, NULL);
INSERT INTO `DBLaborico`.`usuario` (`idUsuario`, `idTipoUsuario`, `idProfesion`, `nombresUsuario`, `documentoUsuario`, `emailUsuario`, `passwordUsuario`, `telefonoUsuario`, `celularUsuario`, `direccionUsuario`, `tipoDocumentoUsuario`, `ciudadUsuario`) VALUES (4, 4, 1, 'administrativo', '4', 'administrativo@administrativo.com', '$2y$10$WkhAKv0GBqJWeBSqRrLN1uhs7DfymtV6T/qNgheXdi7aEbeAsYu3e', DEFAULT, NULL, NULL, NULL, NULL);

COMMIT;


-- -----------------------------------------------------
-- Data for table `DBLaborico`.`tipoPregunta`
-- -----------------------------------------------------
START TRANSACTION;
USE `DBLaborico`;
INSERT INTO `DBLaborico`.`tipoPregunta` (`idTipoPregunta`, `descripcionTipoPregunta`) VALUES (1, 'Opción múltiple con única respuesta');

COMMIT;


-- -----------------------------------------------------
-- Data for table `DBLaborico`.`asignatura`
-- -----------------------------------------------------
START TRANSACTION;
USE `DBLaborico`;
INSERT INTO `DBLaborico`.`asignatura` (`idAsignatura`, `nombreAsignatura`) VALUES (1, 'Lectura crítica');
INSERT INTO `DBLaborico`.`asignatura` (`idAsignatura`, `nombreAsignatura`) VALUES (2, 'Matemáticas');
INSERT INTO `DBLaborico`.`asignatura` (`idAsignatura`, `nombreAsignatura`) VALUES (3, 'Sociales y ciudadanas');
INSERT INTO `DBLaborico`.`asignatura` (`idAsignatura`, `nombreAsignatura`) VALUES (4, 'Ciencias Naturales');
INSERT INTO `DBLaborico`.`asignatura` (`idAsignatura`, `nombreAsignatura`) VALUES (5, 'Inglés');
INSERT INTO `DBLaborico`.`asignatura` (`idAsignatura`, `nombreAsignatura`) VALUES (6, 'Contexto');
INSERT INTO `DBLaborico`.`asignatura` (`idAsignatura`, `nombreAsignatura`) VALUES (7, 'N/A');

COMMIT;

